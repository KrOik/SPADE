<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>åœ°ç†ä½ç½®è¯­è¨€æ£€æµ‹æµ‹è¯•</title>
    <style>
        body {
            font-family: Arial, sans-serif;
            margin: 0;
            padding: 20px;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            min-height: 100vh;
            color: white;
        }
        
        .container {
            max-width: 800px;
            margin: 0 auto;
            background: rgba(255, 255, 255, 0.1);
            padding: 30px;
            border-radius: 15px;
            backdrop-filter: blur(10px);
            border: 1px solid rgba(255, 255, 255, 0.2);
        }
        
        h1 {
            text-align: center;
            margin-bottom: 30px;
            font-size: 2.5em;
            text-shadow: 2px 2px 4px rgba(0, 0, 0, 0.3);
        }
        
        .test-section {
            margin: 20px 0;
            padding: 20px;
            background: rgba(255, 255, 255, 0.1);
            border-radius: 10px;
            border: 1px solid rgba(255, 255, 255, 0.2);
        }
        
        .test-button {
            background: linear-gradient(45deg, #ff6b6b, #ee5a24);
            color: white;
            border: none;
            padding: 12px 24px;
            border-radius: 25px;
            cursor: pointer;
            font-size: 16px;
            margin: 10px;
            transition: all 0.3s ease;
            box-shadow: 0 4px 15px rgba(0, 0, 0, 0.2);
        }
        
        .test-button:hover {
            transform: translateY(-2px);
            box-shadow: 0 6px 20px rgba(0, 0, 0, 0.3);
        }
        
        .status {
            margin: 10px 0;
            padding: 10px;
            border-radius: 5px;
            background: rgba(255, 255, 255, 0.1);
        }
        
        .info {
            background: rgba(52, 152, 219, 0.3);
            border-left: 4px solid #3498db;
        }
        
        .success {
            background: rgba(46, 204, 113, 0.3);
            border-left: 4px solid #2ecc71;
        }
        
        .warning {
            background: rgba(241, 196, 15, 0.3);
            border-left: 4px solid #f1c40f;
        }
        
        .error {
            background: rgba(231, 76, 60, 0.3);
            border-left: 4px solid #e74c3c;
        }
        
        .language-selector-container {
            position: fixed;
            top: 20px;
            right: 20px;
            z-index: 1000;
        }
        
        .test-controls {
            display: flex;
            flex-wrap: wrap;
            gap: 10px;
            margin: 20px 0;
        }
        
        .mock-country {
            background: rgba(255, 255, 255, 0.2);
            padding: 10px;
            border-radius: 5px;
            margin: 5px;
            display: inline-block;
        }
        
        .country-list {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(150px, 1fr));
            gap: 10px;
            margin: 20px 0;
        }
    </style>
</head>
<body>
    <div class="container">
        <h1>ğŸŒ åœ°ç†ä½ç½®è¯­è¨€æ£€æµ‹æµ‹è¯•</h1>
        
        <div class="test-section">
            <h2>ğŸ“‹ æµ‹è¯•è¯´æ˜</h2>
            <p>æ­¤é¡µé¢ç”¨äºæµ‹è¯•åŸºäºåœ°ç†ä½ç½®çš„è¯­è¨€è‡ªåŠ¨æ£€æµ‹åŠŸèƒ½ï¼š</p>
            <ul>
                <li>âœ… è‡ªåŠ¨è°ƒç”¨ ipapi.co API è·å–ç”¨æˆ·åœ°ç†ä½ç½®</li>
                <li>âœ… æ ¹æ®å›½å®¶ä»£ç åŒ¹é…æ”¯æŒçš„è¯­è¨€</li>
                <li>âœ… å¦‚æœç”¨æˆ·æ‰€åœ¨åœ°ä¸åœ¨æ”¯æŒè¯­è¨€å†…ï¼Œæ˜¾ç¤ºè‹±æ–‡æç¤º</li>
                <li>âœ… æ›´æ–°è¯­è¨€é€‰æ‹©å™¨çŠ¶æ€ä¸ºè‹±æ–‡</li>
            </ul>
        </div>
        
        <div class="test-section">
            <h2>ğŸ¯ æµ‹è¯•æ§åˆ¶</h2>
            <div class="test-controls">
                <button class="test-button" onclick="testGeoLocation()">ğŸŒ æµ‹è¯•åœ°ç†ä½ç½®æ£€æµ‹</button>
                <button class="test-button" onclick="clearNotification()">ğŸ—‘ï¸ æ¸…é™¤é€šçŸ¥æ ‡è®°</button>
                <button class="test-button" onclick="resetLanguage()">ğŸ”„ é‡ç½®è¯­è¨€</button>
                <button class="test-button" onclick="showNotification()">ğŸ’¬ æ‰‹åŠ¨æ˜¾ç¤ºé€šçŸ¥</button>
            </div>
        </div>
        
        <div class="test-section">
            <h2>ğŸŒ æ”¯æŒçš„å›½å®¶/è¯­è¨€æ˜ å°„</h2>
            <div class="country-list">
                <div class="mock-country">ğŸ‡¨ğŸ‡³ CN â†’ ä¸­æ–‡</div>
                <div class="mock-country">ğŸ‡¹ğŸ‡¼ TW â†’ ä¸­æ–‡</div>
                <div class="mock-country">ğŸ‡­ğŸ‡° HK â†’ ä¸­æ–‡</div>
                <div class="mock-country">ğŸ‡¸ğŸ‡¬ SG â†’ ä¸­æ–‡</div>
                <div class="mock-country">ğŸ‡ªğŸ‡¸ ES â†’ EspaÃ±ol</div>
                <div class="mock-country">ğŸ‡²ğŸ‡½ MX â†’ EspaÃ±ol</div>
                <div class="mock-country">ğŸ‡¦ğŸ‡· AR â†’ EspaÃ±ol</div>
                <div class="mock-country">ğŸ‡¨ğŸ‡´ CO â†’ EspaÃ±ol</div>
                <div class="mock-country">ğŸ‡µğŸ‡ª PE â†’ EspaÃ±ol</div>
                <div class="mock-country">ğŸ‡©ğŸ‡ª DE â†’ Deutsch</div>
                <div class="mock-country">ğŸ‡¦ğŸ‡¹ AT â†’ Deutsch</div>
                <div class="mock-country">ğŸ‡¨ğŸ‡­ CH â†’ Deutsch</div>
                <div class="mock-country">ğŸ‡¯ğŸ‡µ JP â†’ æ—¥æœ¬èª</div>
                <div class="mock-country">ğŸ‡ºğŸ‡¸ US â†’ English</div>
                <div class="mock-country">ğŸ‡¬ğŸ‡§ GB â†’ English</div>
                <div class="mock-country">ğŸ‡¨ğŸ‡¦ CA â†’ English</div>
                <div class="mock-country">ğŸ‡¦ğŸ‡º AU â†’ English</div>
                <div class="mock-country">ğŸ‡³ğŸ‡¿ NZ â†’ English</div>
            </div>
        </div>
        
        <div class="test-section">
            <h2>ğŸ“Š æµ‹è¯•çŠ¶æ€</h2>
            <div id="status" class="status info">
                ç­‰å¾…æµ‹è¯•å¼€å§‹...
            </div>
        </div>
        
        <div class="test-section">
            <h2>ğŸ”§ åŠŸèƒ½è¯´æ˜</h2>
            <div class="info">
                <h3>è‡ªåŠ¨æ£€æµ‹æµç¨‹ï¼š</h3>
                <ol>
                    <li>é¡µé¢åŠ è½½åå»¶è¿Ÿ1ç§’æ‰§è¡Œåœ°ç†ä½ç½®æ£€æµ‹</li>
                    <li>è°ƒç”¨ ipapi.co/json/ API è·å–ç”¨æˆ·å›½å®¶ä»£ç </li>
                    <li>æ ¹æ®å›½å®¶ä»£ç æ˜ å°„åˆ°æ”¯æŒçš„è¯­è¨€</li>
                    <li>å¦‚æœè¯­è¨€ä¸åœ¨æ”¯æŒåˆ—è¡¨ä¸­ï¼Œæ˜¾ç¤º"Language has been set to English"é€šçŸ¥</li>
                    <li>è‡ªåŠ¨å°†è¯­è¨€é€‰æ‹©å™¨çŠ¶æ€æ›´æ–°ä¸ºè‹±æ–‡</li>
                </ol>
            </div>
            
            <div class="warning">
                <h3>æ³¨æ„äº‹é¡¹ï¼š</h3>
                <ul>
                    <li>é€šçŸ¥é€æ˜åº¦è®¾ç½®ä¸º45%ï¼Œç¬¦åˆè¦æ±‚</li>
                    <li>é€šçŸ¥ä¼šåœ¨5ç§’åè‡ªåŠ¨æ¶ˆå¤±</li>
                    <li>ä½¿ç”¨sessionStorageé¿å…é‡å¤æ˜¾ç¤ºé€šçŸ¥</li>
                    <li>æ”¯æŒç§»åŠ¨ç«¯å“åº”å¼è®¾è®¡</li>
                </ul>
            </div>
        </div>
    </div>
    
    <!-- è¯­è¨€é€‰æ‹©å™¨å®¹å™¨ -->
    <div class="language-selector-container" id="languageSelectorMinimal"></div>
    
    <!-- å¼•å…¥è¯­è¨€é€‰æ‹©å™¨è„šæœ¬ -->
    <script src="../js/language-selector-minimal.js"></script>
    
    <script>
        // æµ‹è¯•å‡½æ•°
        function testGeoLocation() {
            updateStatus('æ­£åœ¨æµ‹è¯•åœ°ç†ä½ç½®æ£€æµ‹...', 'info');
            
            // æ¨¡æ‹ŸAPIè°ƒç”¨
            fetch('https://ipapi.co/json/')
                .then(response => response.json())
                .then(data => {
                    const countryCode = data.country_code;
                    const detectedLanguage = mapCountryToLanguage(countryCode);
                    const supportedLanguages = ['en', 'zh-Hans', 'es', 'de', 'ja'];
                    
                    let message = `æ£€æµ‹åˆ°å›½å®¶: ${countryCode} (${data.country_name})<br>`;
                    message += `æ˜ å°„è¯­è¨€: ${detectedLanguage}<br>`;
                    
                    if (supportedLanguages.includes(detectedLanguage)) {
                        message += `âœ… è¯­è¨€åœ¨æ”¯æŒåˆ—è¡¨ä¸­ï¼Œå°†è‡ªåŠ¨åˆ‡æ¢åˆ° ${detectedLanguage}`;
                        updateStatus(message, 'success');
                    } else {
                        message += `âš ï¸ è¯­è¨€ä¸åœ¨æ”¯æŒåˆ—è¡¨ä¸­ï¼Œå°†æ˜¾ç¤ºè‹±æ–‡é€šçŸ¥å¹¶è®¾ç½®ä¸ºè‹±æ–‡`;
                        updateStatus(message, 'warning');
                    }
                })
                .catch(error => {
                    updateStatus(`âŒ APIè°ƒç”¨å¤±è´¥: ${error.message}`, 'error');
                });
        }
        
        function clearNotification() {
            if (window.SPADE_LANGUAGE_SELECTOR_MINIMAL) {
                window.SPADE_LANGUAGE_SELECTOR_MINIMAL.clearNotificationMark();
                updateStatus('âœ… é€šçŸ¥æ ‡è®°å·²æ¸…é™¤ï¼Œå¯ä»¥é‡æ–°æ˜¾ç¤ºé€šçŸ¥', 'success');
            } else {
                updateStatus('âŒ è¯­è¨€é€‰æ‹©å™¨æœªåˆå§‹åŒ–', 'error');
            }
        }
        
        function resetLanguage() {
            localStorage.removeItem('spade_language');
            location.reload();
        }
        
        function showNotification() {
            if (window.SPADE_LANGUAGE_SELECTOR_MINIMAL && window.SPADE_LANGUAGE_SELECTOR_MINIMAL.getInstance()) {
                window.SPADE_LANGUAGE_SELECTOR_MINIMAL.getInstance().showLanguageNotification();
                updateStatus('âœ… æ‰‹åŠ¨æ˜¾ç¤ºé€šçŸ¥', 'success');
            } else {
                updateStatus('âŒ è¯­è¨€é€‰æ‹©å™¨æœªåˆå§‹åŒ–', 'error');
            }
        }
        
        function updateStatus(message, type) {
            const statusElement = document.getElementById('status');
            statusElement.className = `status ${type}`;
            statusElement.innerHTML = message;
        }
        
        function mapCountryToLanguage(countryCode) {
            const countryLanguageMap = {
                'CN': 'zh-Hans', 'TW': 'zh-Hans', 'HK': 'zh-Hans', 'SG': 'zh-Hans',
                'ES': 'es', 'MX': 'es', 'AR': 'es', 'CO': 'es', 'PE': 'es',
                'DE': 'de', 'AT': 'de', 'CH': 'de',
                'JP': 'ja',
                'US': 'en', 'GB': 'en', 'CA': 'en', 'AU': 'en', 'NZ': 'en'
            };
            return countryLanguageMap[countryCode] || 'en';
        }
        
        // é¡µé¢åŠ è½½å®Œæˆåçš„åˆå§‹åŒ–
        document.addEventListener('DOMContentLoaded', () => {
            updateStatus('âœ… é¡µé¢å·²åŠ è½½ï¼Œè¯­è¨€é€‰æ‹©å™¨å·²åˆå§‹åŒ–', 'success');
            
            // ç›‘å¬è¯­è¨€é€‰æ‹©å™¨äº‹ä»¶
            document.addEventListener('languageSelector:initialized', () => {
                updateStatus('âœ… è¯­è¨€é€‰æ‹©å™¨åˆå§‹åŒ–å®Œæˆï¼Œåœ°ç†ä½ç½®æ£€æµ‹å°†åœ¨1ç§’åå¼€å§‹', 'success');
            });
            
            document.addEventListener('languageSelector:languageChanged', (event) => {
                updateStatus(`âœ… è¯­è¨€å·²åˆ‡æ¢: ${event.detail.from} â†’ ${event.detail.to}`, 'success');
            });
        });
    </script>
</body>
</html>
